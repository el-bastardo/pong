<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Pong</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <p id="scorePlayerOne"></p>
    <canvas id="myCanvas"></canvas>
    <p id="scorePlayerTwo"></p>
    <script>
        // define canvas
        var canvas = document.getElementById("myCanvas");
        var ctx = canvas.getContext("2d");
        canvas.width = 500;
        canvas.height = 500;

        // define playerOne
        var playerOne = {
            x: 215, // (canvas.width - playerOne.width) / 2,
            y: 20,
            width: 70,
            height: 20,
            score: 0,
            style: "#003366",
            scoreAnzeige: "scorePlayerOne",
        }

        // define playerTwo
        var playerTwo = {
            x: 215,
            y: 460,
            width: 70,
            height: 20,
            score: 0,
            style: "#990033",
            scoreAnzeige: "scorePlayerTwo",
        }
        
        // define Controller for playerOne
        var controllerOne = {
            
        }
        
        var controllerTwo = {
            
        }

        var ball = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            ballRadius: 10,
            dx: 1.5,
            dy: -1.5,
        }

        function renderCanvas() {
            ctx.fillStyle = "#000000";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }
        
        function renderPlayer(playerData) {
            ctx.fillStyle = playerData.style;
            ctx.fillRect(playerData.x, playerData.y, playerData.width, playerData.height);
            ctx.strokeRect(playerData.x, playerData.y, playerData.width, playerData.height);
        }
        
        function updateScore(scoreData, id) {
            var anzeige = document.getElementById(scoreData.scoreAnzeige);
            anzeige.innerHTML = "Score: " + scoreData.score;
        }

        //move playerOne using left and right arrow key and playerTwo using A and D
        function movePlayer() {

            window.onkeydown = function(event) {
                var keyPr = event.keyCode; //Key code of key pressed

                if (keyPr === 39 && playerOne.x < canvas.width - playerOne.width) {
                    playerOne.x += 40; //right arrow add 20 from current
                } else if (keyPr === 37 && playerOne.x > 10) {
                    playerOne.x -= 40; //left arrow subtract 20 from current
                } else if (keyPr === 68 && playerTwo.x <= canvas.width - playerTwo.width) {
                    playerTwo.x += 40; //D add 20 from current)
                } else if (keyPr === 65 && playerTwo.x > 10) {
                    playerTwo.x -= 40; //A subtract 20 from current
                }

                controllerOne[keyPr] = true;
                console.log(controllerOne);
            }
        }

        function renderBall() {
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.ballRadius, 0, 2 * Math.PI);
            ctx.fillStyle = "#FFFFFF";
            ctx.fill();

            if (ball.x + ball.dx > canvas.width - ball.ballRadius) {
                ball.dx = -ball.dx;
            }
            if (ball.x + ball.dx < ball.ballRadius) {
                ball.dx = -ball.dx;
            }
            if (ball.x - ball.ballRadius >= playerOne.x && ball.x - ball.ballRadius <= playerOne.x + playerOne.width && ball.y - ball.ballRadius >= playerOne.y && ball.y - ball.ballRadius <= playerOne.y + playerOne.height) {
                //  ball.dx = -ball.dx;
                ball.dy = -ball.dy;
            }
            if (ball.x + ball.ballRadius >= playerTwo.x && ball.x + ball.ballRadius <= playerTwo.x + playerTwo.width && ball.y + ball.ballRadius >= playerTwo.y && ball.y + ball.ballRadius <= playerTwo.y + playerTwo.height) {
                //  ball.dx = -ball.dx;
                ball.dy = -ball.dy;
            }
            if (ball.y + ball.dy > canvas.height - ball.ballRadius) {
                restart();
                playerOne.score++;
            }
            if (ball.y + ball.dy < ball.ballRadius) {
                restart();
                playerTwo.score++;
            }

            ball.x += ball.dx;
            ball.y += ball.dy;
        }

        function game() {
            renderCanvas();
            renderPlayer(playerOne);
            renderPlayer(playerTwo);
            updateScore(playerOne, "scorePlayerOne");
            updateScore(playerTwo, "scorePlayerTwo");
            renderBall();
            movePlayer();
        }

        var interval = setInterval(game, 10);

        function restart() {
            ball.x = canvas.width / 2;
            ball.y = canvas.height / 2;
        }
    </script>
</body></html>
